## 2024-05-18 - [Fix Unhandled TypeError in Admin Login Endpoint]
**Vulnerability:** A Denial of Service (DoS) and unhandled exception risk existed in `server/api/admin/login.post.ts`. The endpoint read the `password` property from the JSON body but did not validate its type. A malicious user could send an array or object (e.g., `{"password": []}`) which would pass truthiness checks but cause `crypto.createHash('sha256').update(password)` to throw a synchronous `TypeError [ERR_INVALID_ARG_TYPE]`, resulting in a 500 Internal Server Error instead of a 400 Bad Request.
**Learning:** Even when checking for presence (`if (!password)`) and length (`if (password.length > 1024)`), type confusion can occur if the input is parsed from JSON (where it can be an object or array). Methods like `crypto.update()` strictly require strings or buffers.
**Prevention:** Always validate that the expected scalar type (e.g., `typeof password === 'string'`) is matched before passing user input to strictly-typed Node.js built-ins. Use Zod schemas where possible, or add explicit type guards.
